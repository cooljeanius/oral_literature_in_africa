-- Originally written by pdurrant and posted for download at http://www.mobileread.com/forums/showthread.php?t=55681-- Version 1.0.3 Update by Dan Rodney http://www.danrodney.com for Noble Desktop http://www.nobledesktop.com-- New in 1.0.3: To speed things up, the Confirmation message at the end was removed (It is still in the code, just uncomment it). -- New in 1.0.3: Dialog messages were edited to be more clear and consistent with ePub UnZip 1.0on zipePub(ePubFolder)	set CarryOn to true	tell application "Finder"		set ePubName to ((name of folder ePubFolder) as text) & ".epub"		set ePubParent to (container of ePubFolder) as text		set ePubFileAlias to (ePubParent & ePubName)		try			get ePubFileAlias as alias			if ePubFileAlias exists then				set question to display dialog ("The ePub file \"" & ePubName & "\" already exists.\n\nDo you want to replace it? The old file will be moved to the Trash.") with title Â					"ePub Zip" with icon caution buttons Â					{"Stop", "Replace"} default button 2				set answer to button returned of question				if answer is equal to "Stop" then					set CarryOn to false				else					move ePubFileAlias to trash				end if			end if		end try	end tell		if (CarryOn) then		set ePubFolderPath to POSIX path of ePubFolder as text		set ePubFilePath to POSIX path of file (ePubParent & ePubName)		set shellcommand to "cd \"" & ePubFolderPath & "\";zip -X0 \"" & ePubFilePath & "\" mimetype"		try			set result to do shell script shellcommand					on error result			try				display dialog "Problem adding mimetype file to ePub:" with title Â					"ePub Zip " with icon caution Â					default answer Â					result buttons ("Bother") default button 1			end try			set CarryOn to false		end try	end if		if (CarryOn) then		set shellcommand to "cd \"" & ePubFolderPath & "\"; zip -rDX9 \"" & ePubFilePath & "\" * -x \"*.DS_Store\" -x mimetype"		try			set result to do shell script shellcommand					on error result			try				display dialog "Problem adding remaining files to ePub:" with title Â					"ePub Zip " with icon caution Â					default answer Â					result buttons ("Bother") default button 1			end try			set CarryOn to false					end try	end if		if (CarryOn) then		-- display dialog ePubName & " created successfully." with title "ePub Zip" buttons ("OK") default button 1 giving up after 1	end ifend zipePubon run	set ePubFolder to (choose folder with prompt "Please choose the folder of the ePub you want to zip.")	zipePub(ePubFolder)end runon open some_items	repeat with this_item in some_items		if (folder of (info for this_item) is true) then			set ePubFolder to this_item			zipePub(ePubFolder)		end if	end repeatend open