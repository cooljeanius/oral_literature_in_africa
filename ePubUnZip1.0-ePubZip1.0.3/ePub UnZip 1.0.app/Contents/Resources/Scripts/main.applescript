-- Created by Dan Rodney http://www.danrodney.com for Noble Desktop http://www.nobledesktop.com-- Inspired by ePub Zip 1.0.2.app originally written by pdurrant and found at http://www.mobileread.com/forums/showthread.php?t=55681on remove_extension(this_name)	if this_name contains "." then		set this_name to (the reverse of every character of this_name) as string		set x to the offset of "." in this_name		set this_name to (text (x + 1) thru -1 of this_name)		set this_name to (the reverse of every character of this_name) as string	end if	return this_nameend remove_extensionon unZipePub(ePubFile)	set CarryOn to true	tell application "Finder"		set ePubName to ((name of file ePubFile) as text) -- returns the name with the extension	end tell		set ePubNameWithoutExtension to remove_extension(ePubName) --file extension has been removed		tell application "Finder"		set ePubParent to (container of ePubFile) as text		set ePubFolderAlias to (ePubParent & ePubNameWithoutExtension)		try			get ePubFolderAlias as alias			if ePubFolderAlias exists then				set question to display dialog ("The \"" & ePubNameWithoutExtension & "\" folder already exists.\n\nDo you want to replace it? The old folder will be moved to the Trash.") with title Â					"ePub UnZip" with icon caution buttons {"Stop", "Replace"} default button 2				set answer to button returned of question				if answer is equal to "Stop" then					set CarryOn to false				else					move ePubFolderAlias to trash				end if			end if		end try	end tell		if (CarryOn) then		try			tell application "Finder"				set unzippedePubFolder to (make new folder at ePubParent with properties {name:ePubNameWithoutExtension}) as text			end tell					on error result			try				display dialog "Problem creating the folder for the unzipped ePub:" with title Â					"ePub UnZip " with icon caution Â					default answer Â					result buttons ("Bother") default button 1			end try			set CarryOn to false		end try	end if		if (CarryOn) then		set ePubParentFolderPath to POSIX path of unzippedePubFolder as text		set ePubFilePath to POSIX path of file (ePubParent & ePubName)		set shellcommand to "cd \"" & ePubParentFolderPath & "\";unzip \"" & ePubFilePath & "\""		try			set result to do shell script shellcommand					on error result			try				display dialog "Problem unzipping the ePub:" with title Â					"ePub UnZip " with icon caution Â					default answer Â					result buttons ("Bother") default button 1			end try			set CarryOn to false		end try	end if		if (CarryOn) then		-- display dialog ePubName & " was unzipped successfully." with title "ePub UnZip" buttons ("OK") default button 1 giving up after 1	end ifend unZipePubon run	set ePubFile to (choose file with prompt "Please choose the ePub file you want to unzip.")	unZipePub(ePubFile)end runon open some_items	repeat with this_item in some_items		if (folder of (info for this_item) is false) then			unZipePub(this_item)		end if	end repeatend open